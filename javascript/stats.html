<script>



  // ==================== AVANCES (ESTADÍSTICAS) ====================
  function loadEstadisticas() {
    showLoading();

    google.script.run
      .withSuccessHandler(onEstadisticasLoaded)
      .withFailureHandler(function (error) {
        hideLoading();
        console.error('Error cargando estadísticas:', error);
        renderEstadisticas([]);
      })
      .obtenerEstadisticasMaquinas();
  }

  function onEstadisticasLoaded(result) {
    hideLoading();

    if (result && result.success) {
      renderEstadisticas(result.estadisticas || []);
    } else {
      renderEstadisticas([]);
    }
  }

  function renderEstadisticas(estadisticas) {
    const container = document.getElementById('avances-grid');
    container.innerHTML = '';

    if (!estadisticas || estadisticas.length === 0) {
      container.innerHTML = '<p class="config-placeholder">No hay estadísticas disponibles</p>';
      return;
    }

    estadisticas.forEach(stat => {
      const item = document.createElement('div');
      item.className = 'avance-item';
      item.innerHTML = `
      <div class="avance-header">
        <span class="avance-name">${stat.maquinaNombre}</span>
        <span class="avance-percentage">${stat.porcentaje} %</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: ${stat.porcentaje}%"></div>
      </div>
    `;
      container.appendChild(item);
    });
  }

</script>